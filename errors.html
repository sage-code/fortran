<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="description" content="Comprehensive introduction to Fortran error handling.">
  <meta name="author" content="Elucian Moise">
  <meta name="keywords" content="fortran, error, handling, tutorial">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Website title -->
  <title>Fortran Errors</title>  

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <!-- Icon -->
  <link rel="icon" type="image/png"  href="../images/favicon.ico">  
  <!-- Prism Highlighter -->
  <link rel="stylesheet" href="../prism.css">
  <script src="../prism.js"></script>
  <!-- custom css -->
  <link rel="stylesheet" href="../sage.css">
</head>

<body>

<div class="container">
        
<!-- header -->
<div class="row">
    <div class="col">
        <a href="https://sagecode.net"><img src="../images/sage-logo.svg" alt="Sage-Code Laboratory" height="80"/></a>
    </div>  
    <div class="col  bottom-right">
        <a href="index.html#lang-index">index</a>&lt;--
    </div>
</div><hr>

<h1>Fortran Errors</h1>

<div class="alert alert-secondary shadow-sm">Do not expect for a try...catch block that is available in modern languages. In standard Fortran, when there is an error, the program just stop working and automaticly exit. The only exception is write, where you can use err=label to make a jump in case of error.</div>

<h4>Topics & Bookmarks</h4>

<p>The recent versions of Fortran have error management for specific operations that can fail, but you can recover from error and stop program from crashing. Modern Fortran has introduced four main areas for error capture:</p>

<ol>
<li><a href="#fileh">File handling and I/O</a></li>
<li><a href="#IEEE">IEEE floating point errors</a></li>
<li><a href="#daloc">Dynamic allocation</a></li>
<li><a href=#cline">Command line operations</a></li>
</ol>

<h2><a id="fileh"></a>File handling and I/O</h2>

<p>All the external file handling statements and I/O operations can take <em>iostat</em> and <em>iomsg</em> clauses. iostat is an integer which returns a non-zero value if there is an error, in which case, the character variable assigned to iomsg will return a brief error message.</p>

<!--code pannel-->
<div class="panel">
<div class="panel-heading">example: error.f95</div>
<div class="panel-body">
<pre class="code-panel"><code class="language-fortran line-numbers">program error
  integer :: io_stat
  character (len=256) :: io_msg
  ! try to open a file that do not exist  
  open (file='myFile.dat', unit=10, &
        access = "append", status="old", &
        iostat=io_stat, iomsg=io_msg)
  ! analyze the error
  if (io_stat/=0) then
    write (*,*) "Open myFile.dat failed."
    write (*,*) "iostat = ", io_stat
    write (*,*) "iomsg = ", trim(io_msg)
  else
    write (*,*) "File was open succesfuly."
    close (unit=10)
  end if
end program
</code></pre>
</div></div>

<!--console pannel-->
<div class="panel">
<div class="panel-heading">console</div>
<div class="panel-body">
<pre class="code-panel"><code class="language-output"
>&ft;./error
 Open myFile.dat failed.
 iostat =            2
 iomsg = Cannot open file myFile.dat: No such file or directory
</code></pre>
</div></div>

<h4>Notes:</h4>

<ol>
<li>In modern fortran, the err=lable clause is still supported but should not be used.</li>

<li>The non-zero integers and the messages are depending on the compiler. </li>

<li>The intrinsic module, <em>iso_fortran_env</em>, gives access to two important values: <em>iostat_end</em> and <em>iostat_eor</em>. </li>

<li>If <em>iostat</em> is non-zero, this is a signal of an error but the execution will not stop, except if you call <em>stop</em> statement explicit.</li>
</ol>


<h2><a id="IEEE"></a>IEEE floating point errors</h2>
<!-- todo -->
<h2><a id="daloc"></a>Dynamic allocation</h2>
<!-- todo -->
<h2><a id="cline"></a>Command line operations</h2>
<!-- todo -->

<!-- a regular diagram -->
<div class="text-center">
  <img src="../images/while.svg" alt="no description"
       width="600" class="img-fluid protect rounded shadow border" >
  <p>While Loop</p>
</div>


<!--two columns pattern-->
<div class="row">
<!-- first column -->
<div class="column col-md-6 panel">
<div class="panel-heading">example</div>
<div class="panel-body">
<pre class="code-panel">
<code class="language-bash line-numbers">program error
  integer :: io_stat
  character (len=256) :: io_msg
  ! try to open a file that do not exist  
  open (file='myFile.dat', unit=10, &
        access = "append", status="old", &
        iostat=io_stat, iomsg=io_msg)
  ! analyze the error
  if (io_stat/=0) then
    write (*,*) "Open myFile.dat failed."
    write (*,*) "iostat = ", io_stat
    write (*,*) "iomsg = ", trim(io_msg)
  else
    write (*,*) "File was open succesfuly."
    close (unit=10)
  end if
end program
</code></pre>
</div>
</div>
<!-- second column -->
<div class="column col-md-6 panel">
<div class="panel-heading">console</div>
<div class="panel-body">
<pre class="code-panel">
<code class="language-output"
>&ft;./error
 Open myFile.dat failed.
 iostat =            2
 iomsg = Cannot open file 
 myFile.dat: No such file 
 or directory
</code></pre>
</div>
</div>
</div>

<!-- simple table-->
<table class="table table-bordered table-striped" style="width: 100%;">
<tr>    
    <th>Symbol</th>
    <th>Description</th>
    <th>Example</th>
</tr></thead>

<tbody>
<tr>
    <td>#cell</td>
    <td>#cell</td>
    <td>#cell</td>
</tr>
</tbody>
</table>

<!-- work in progress-->

<hr>
<p><b>Read next:</b>
<a href="parallel.html">Parallel Computing</a></p>

<!-- Footer -->
<footer class="footer">
  <div class="footer-copyright text-center"></div>
</footer>

</div></body></html>